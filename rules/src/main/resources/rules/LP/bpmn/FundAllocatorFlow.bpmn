<?xml version="1.0" encoding="UTF-8"?> 
<definitions id="Definition"
             targetNamespace="http://www.jboss.org/drools"
             typeLanguage="http://www.java.com/javaTypes"
             expressionLanguage="http://www.mvel.org/2.0"
             xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xsi:schemaLocation="http://www.omg.org/spec/BPMN/20100524/MODEL BPMN20.xsd"
             xmlns:g="http://www.jboss.org/drools/flow/gpd"
             xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI"
             xmlns:dc="http://www.omg.org/spec/DD/20100524/DC"
             xmlns:di="http://www.omg.org/spec/DD/20100524/DI"
             xmlns:tns="http://www.jboss.org/drools">

  <itemDefinition id="_contextEntityItem" structureRef="com.thirdpillar.codify.loanpath.model.FundAllocator" />
  <itemDefinition id="_fundAllocatorsEmailListItem" structureRef="String" />
  <itemDefinition id="_dealEntityItem" structureRef="com.thirdpillar.codify.loanpath.model.Deal" />
  <itemDefinition id="_fundAllocatorHistoryItem" structureRef="com.thirdpillar.codify.loanpath.model.FundAllocatorHistory" />
  <itemDefinition id="_integrationExchangeItem" structureRef="com.thirdpillar.foundation.integration.IntegrationExchange" />
  <itemDefinition id="_integrationResultStatusItem" structureRef="String" />
  <itemDefinition id="_sfdcInputMapItem" structureRef="java.util.Map" />

  <itemDefinition id="_3-contextEntityItem" structureRef="com.thirdpillar.codify.loanpath.model.FundAllocator" />
  <itemDefinition id="_3-fundAllocatorsEmailListItem" structureRef="String" />
  <itemDefinition id="_3-dealEntityItem" structureRef="com.thirdpillar.codify.loanpath.model.Deal" />
  <itemDefinition id="_3-fundAllocatorHistoryItem" structureRef="com.thirdpillar.codify.loanpath.model.FundAllocatorHistory" />
  <itemDefinition id="_3-integrationExchangeItem" structureRef="com.thirdpillar.foundation.integration.IntegrationExchange" />
  <itemDefinition id="_3-integrationResultStatusItem" structureRef="String" />
  <itemDefinition id="_3-sfdcInputMapItem" structureRef="java.util.Map" />

  <itemDefinition id="_6-contextEntityItem" structureRef="com.thirdpillar.codify.loanpath.model.FundAllocator" />
  <itemDefinition id="_6-fundAllocatorsEmailListItem" structureRef="String" />
  <itemDefinition id="_6-dealEntityItem" structureRef="com.thirdpillar.codify.loanpath.model.Deal" />
  <itemDefinition id="_6-fundAllocatorHistoryItem" structureRef="com.thirdpillar.codify.loanpath.model.FundAllocatorHistory" />
  <itemDefinition id="_6-integrationExchangeItem" structureRef="com.thirdpillar.foundation.integration.IntegrationExchange" />
  <itemDefinition id="_6-integrationResultStatusItem" structureRef="String" />
  <itemDefinition id="_6-sfdcInputMapItem" structureRef="java.util.Map" />

  <itemDefinition id="_25-contextEntityItem" structureRef="com.thirdpillar.codify.loanpath.model.FundAllocator" />
  <itemDefinition id="_25-fundAllocatorsEmailListItem" structureRef="String" />
  <itemDefinition id="_25-dealEntityItem" structureRef="com.thirdpillar.codify.loanpath.model.Deal" />
  <itemDefinition id="_25-fundAllocatorHistoryItem" structureRef="com.thirdpillar.codify.loanpath.model.FundAllocatorHistory" />
  <itemDefinition id="_25-integrationExchangeItem" structureRef="com.thirdpillar.foundation.integration.IntegrationExchange" />
  <itemDefinition id="_25-integrationResultStatusItem" structureRef="String" />
  <itemDefinition id="_25-sfdcInputMapItem" structureRef="java.util.Map" />

  <itemDefinition id="_27-contextEntityItem" structureRef="com.thirdpillar.codify.loanpath.model.FundAllocator" />
  <itemDefinition id="_27-fundAllocatorsEmailListItem" structureRef="String" />
  <itemDefinition id="_27-dealEntityItem" structureRef="com.thirdpillar.codify.loanpath.model.Deal" />
  <itemDefinition id="_27-fundAllocatorHistoryItem" structureRef="com.thirdpillar.codify.loanpath.model.FundAllocatorHistory" />
  <itemDefinition id="_27-integrationExchangeItem" structureRef="com.thirdpillar.foundation.integration.IntegrationExchange" />
  <itemDefinition id="_27-integrationResultStatusItem" structureRef="String" />
  <itemDefinition id="_27-sfdcInputMapItem" structureRef="java.util.Map" />

  <itemDefinition id="_26-contextEntityItem" structureRef="com.thirdpillar.codify.loanpath.model.FundAllocator" />
  <itemDefinition id="_26-fundAllocatorsEmailListItem" structureRef="String" />
  <itemDefinition id="_26-dealEntityItem" structureRef="com.thirdpillar.codify.loanpath.model.Deal" />
  <itemDefinition id="_26-fundAllocatorHistoryItem" structureRef="com.thirdpillar.codify.loanpath.model.FundAllocatorHistory" />
  <itemDefinition id="_26-integrationExchangeItem" structureRef="com.thirdpillar.foundation.integration.IntegrationExchange" />
  <itemDefinition id="_26-integrationResultStatusItem" structureRef="String" />
  <itemDefinition id="_26-sfdcInputMapItem" structureRef="java.util.Map" />

  <itemDefinition id="_28-contextEntityItem" structureRef="com.thirdpillar.codify.loanpath.model.FundAllocator" />
  <itemDefinition id="_28-fundAllocatorsEmailListItem" structureRef="String" />
  <itemDefinition id="_28-dealEntityItem" structureRef="com.thirdpillar.codify.loanpath.model.Deal" />
  <itemDefinition id="_28-fundAllocatorHistoryItem" structureRef="com.thirdpillar.codify.loanpath.model.FundAllocatorHistory" />
  <itemDefinition id="_28-integrationExchangeItem" structureRef="com.thirdpillar.foundation.integration.IntegrationExchange" />
  <itemDefinition id="_28-integrationResultStatusItem" structureRef="String" />
  <itemDefinition id="_28-sfdcInputMapItem" structureRef="java.util.Map" />

  <process processType="Private" isExecutable="true" id="FundAllocatorFlow" name="FundAllocatorFlow" tns:packageName="LP" tns:version="1" >

    <extensionElements>
     <tns:import name="java.util.Map" />
     <tns:import name="java.util.List" />
     <tns:import name="java.util.ArrayList" />
     <tns:import name="java.util.HashMap" />
     <tns:import name="com.thirdpillar.codify.loanpath.model.Request" />
     <tns:import name="com.thirdpillar.codify.loanpath.model.Document" />
     <tns:import name="com.thirdpillar.codify.loanpath.model.DocumentGroup" />
     <tns:import name="com.thirdpillar.codify.loanpath.model.*" />
     <tns:import name="java.util.Date" />
    </extensionElements>
    <!-- process variables -->
    <property id="contextEntity" itemSubjectRef="_contextEntityItem"/>
    <property id="fundAllocatorsEmailList" itemSubjectRef="_fundAllocatorsEmailListItem"/>
    <property id="dealEntity" itemSubjectRef="_dealEntityItem"/>
    <property id="fundAllocatorHistory" itemSubjectRef="_fundAllocatorHistoryItem"/>
    <property id="integrationExchange" itemSubjectRef="_integrationExchangeItem"/>
    <property id="integrationResultStatus" itemSubjectRef="_integrationResultStatusItem"/>
    <property id="sfdcInputMap" itemSubjectRef="_sfdcInputMapItem"/>

    <!-- nodes -->
    <startEvent id="_1" name="Start" />
    <endEvent id="_2" name="End" >
        <terminateEventDefinition/>
    </endEvent>
    <task id="_3" name="Wait State" tns:taskName="WaitState" >
      <ioSpecification>
        <inputSet>
        </inputSet>
        <outputSet>
        </outputSet>
      </ioSpecification>
    </task>
    <intermediateCatchEvent id="_4" name="Signal" >
      <signalEventDefinition signalRef="fundedFundAllocation"/>
    </intermediateCatchEvent>
    <endEvent id="_5" name="End" />
    <task id="_6" name="Fund Allocator Email Notification" tns:taskName="NotificationTask" >
      <extensionElements>
        <tns:onExit-script scriptFormat="http://www.java.com/java">
          <script>context.setVariable("fundAllocatorsEmailList",null);</script>
        </tns:onExit-script>
      </extensionElements>
      <ioSpecification>
        <dataInput id="_6_entityInput" name="entity" />
        <dataInput id="_6_validateEntityInput" name="validateEntity" />
        <dataInput id="_6_BodyInput" name="Body" />
        <dataInput id="_6_SubjectInput" name="Subject" />
        <dataInput id="_6_ToInput" name="To" />
        <dataInput id="_6_FromInput" name="From" />
        <dataInput id="_6_Reply-ToInput" name="Reply-To" />
        <inputSet>
          <dataInputRefs>_6_entityInput</dataInputRefs>
          <dataInputRefs>_6_validateEntityInput</dataInputRefs>
          <dataInputRefs>_6_BodyInput</dataInputRefs>
          <dataInputRefs>_6_SubjectInput</dataInputRefs>
          <dataInputRefs>_6_ToInput</dataInputRefs>
          <dataInputRefs>_6_FromInput</dataInputRefs>
          <dataInputRefs>_6_Reply-ToInput</dataInputRefs>
        </inputSet>
        <outputSet>
        </outputSet>
      </ioSpecification>
      <dataInputAssociation>
        <sourceRef>dealEntity</sourceRef>
        <targetRef>_6_entityInput</targetRef>
      </dataInputAssociation>
      <dataInputAssociation>
        <sourceRef>contextEntity</sourceRef>
        <targetRef>_6_validateEntityInput</targetRef>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>_6_BodyInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">fund_allocator_status_email_body</from>
          <to xsi:type="tFormalExpression">_6_BodyInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>_6_SubjectInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">Funding Placement Details: #{contextEntity.wfStatus}</from>
          <to xsi:type="tFormalExpression">_6_SubjectInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>_6_ToInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">#{fundAllocatorsEmailList}</from>
          <to xsi:type="tFormalExpression">_6_ToInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>_6_FromInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">no-reply@thirdpillar.com</from>
          <to xsi:type="tFormalExpression">_6_FromInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>_6_Reply-ToInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">no-reply@thirdpillar.com</from>
          <to xsi:type="tFormalExpression">_6_Reply-ToInput</to>
        </assignment>
      </dataInputAssociation>
    </task>
    <scriptTask id="_7" name="Set Email Address" scriptFormat="http://www.java.com/java" >
      <script>FundAllocator fundAllocator=(FundAllocator)context.getVariable("contextEntity");

StringBuffer buffer = new StringBuffer();

if(fundAllocator.getCapitalProvider() != null &amp;&amp; fundAllocator.getCapitalProvider().getCustomerAssociated() !=null  &amp;&amp; fundAllocator.getCapitalProvider().getCustomerAssociated().getPrimarySite() !=null &amp;&amp; fundAllocator.getCapitalProvider().getCustomerAssociated().getPrimarySite().getSiteDetails() !=null &amp;&amp; (fundAllocator.getCapitalProvider().getCustomerAssociated().getPrimarySite().getSiteDetails().getEmail() !=null || fundAllocator.getCapitalProvider().getCustomerAssociated().getPrimarySite().getSiteDetails().getEmail() !="")){
	String email = fundAllocator.getCapitalProvider().getCustomerAssociated().getPrimarySite().getSiteDetails().getEmail();
	buffer = buffer.append(email).append(";");
}

context.setVariable("dealEntity",fundAllocator.getDeal());
//System.out.println("Email Addresses TO:"+buffer);
context.setVariable("fundAllocatorsEmailList",buffer.toString());</script>
    </scriptTask>
    <scriptTask id="_8" name="Set FundedByCP Date" scriptFormat="http://www.java.com/java" >
      <script>FundAllocator fundAllocator=(FundAllocator)context.getVariable("contextEntity");
//fundAllocator.changeStatus(fundAllocator, "FUNDING_PLACEMENT_STATUS_FUNDED");

//set fundedDate by CP
fundAllocator.setFundedDate(new Date());

//Setting flag true to show SubmitFundingRequest button when Deal Status FullyFunded.
fundAllocator.getDeal().setSubmitFundingRequestFlag(true);

</script>
    </scriptTask>
    <intermediateCatchEvent id="_9" name="Signal" >
      <signalEventDefinition signalRef="failedFundAllocation"/>
    </intermediateCatchEvent>
    <exclusiveGateway id="_11" name="Gateway" gatewayDirection="Converging" />
    <intermediateCatchEvent id="_12" name="Signal" >
      <signalEventDefinition signalRef="replacedFundAllocation"/>
    </intermediateCatchEvent>
    <scriptTask id="_15" name="No of Deal Funded By FP" scriptFormat="http://www.java.com/java" >
      <script>FundAllocator fundAllocator=(FundAllocator)context.getVariable("contextEntity");
if( fundAllocator.getCapitalProvider() != null){
CapitalProvider cp= fundAllocator.getCapitalProvider();
Integer fDeals= cp.getNoOfFundedDeal();
if(fDeals==null )
	fDeals=0; 
cp.setNoOfFundedDeal(fDeals + 1);
}</script>
    </scriptTask>
    <scriptTask id="_16" name="Date of Last Deal By FP" scriptFormat="http://www.java.com/java" >
      <script>FundAllocator fundAllocator=(FundAllocator)context.getVariable("contextEntity");
//LastUpdate
fundAllocator.setLastUpdate(new Date());

if(fundAllocator.getCapitalProvider() !=null ){
CapitalProvider cp= fundAllocator.getCapitalProvider();
cp.setLastDealDt(new Date());
}</script>
    </scriptTask>
    <scriptTask id="_18" name="update Amount Outstanding by FP " scriptFormat="http://www.java.com/java" >
      <script>FundAllocator fundAllocator=(FundAllocator)context.getVariable("contextEntity");

BigDecimal newAmtFunded= fundAllocator.getFundAmt();
if(newAmtFunded==null )
	newAmtFunded=BigDecimal.ZERO; 

if( fundAllocator.getCapitalProvider() != null){
CapitalProvider cp= fundAllocator.getCapitalProvider();
BigDecimal amtOutstanding= cp.getOutstandingPrincipal();
if(amtOutstanding==null )
	amtOutstanding=BigDecimal.ZERO; 
cp.setOutstandingPrincipal(amtOutstanding.add(newAmtFunded));


// fund portion(s) can only be funded after acceptance and after rejction no operatoin can be done on that
BigDecimal pending= cp.getPending();
if(pending==null )
		pending=BigDecimal.ZERO; 
cp.setPending(pending.subtract(newAmtFunded));
}</script>
    </scriptTask>
    <scriptTask id="_23" name="Reduces the Pending Funded oldCP" scriptFormat="http://www.java.com/java" >
      <script>FundAllocator fundAllocator=(FundAllocator)context.getVariable("contextEntity");

if(fundAllocator !=null &amp;&amp; fundAllocator.getWfStatus() !=null &amp;&amp; fundAllocator.getWfStatus().getStatusKey() !=null &amp;&amp; fundAllocator.getWfStatus().getStatusKey().equals("FUNDING_PLACEMENT_STATUS_FUNDED")){
	//convert outsatnding to pending when replaced from Funded by CP status
	BigDecimal newAmtFunded= fundAllocator.getFundAmt();
	if(newAmtFunded==null )
		newAmtFunded=BigDecimal.ZERO; 

	if( fundAllocator.getCapitalProvider() != null){
		CapitalProvider cp= fundAllocator.getCapitalProvider();
		BigDecimal amtOutstanding= cp.getOutstandingPrincipal();
		if(amtOutstanding==null )
			amtOutstanding=BigDecimal.ZERO; 
		cp.setOutstandingPrincipal(amtOutstanding.subtract(newAmtFunded));


		BigDecimal pending= cp.getPending();
		if(pending==null )
			pending=BigDecimal.ZERO; 
		cp.setPending(pending.add(newAmtFunded));
	}
}

BigDecimal newAmtRequested= fundAllocator.getFundAmt();
if(newAmtRequested==null )
	newAmtRequested=BigDecimal.ZERO; 
	
if(fundAllocator.getNewCP() != null){	
   CapitalProvider cp= fundAllocator.getCapitalProvider();
   BigDecimal pending= cp.getPending();
   if(pending==null )
	 pending=BigDecimal.ZERO; 
     cp.setPending(pending.subtract(newAmtRequested));
}
</script>
    </scriptTask>
    <task id="_25" name="Funded By CP -StatusUpdate" tns:taskName="StatusUpdate" >
      <extensionElements>
        <tns:onEntry-script scriptFormat="http://www.java.com/java">
          <script></script>
        </tns:onEntry-script>
        <tns:onEntry-script scriptFormat="http://www.java.com/java">
          <script>System.out.println("updating stauts - Funded by Capital Provider----------------------------&gt;");</script>
        </tns:onEntry-script>
      </extensionElements>
      <ioSpecification>
        <dataInput id="_25_entityInput" name="entity" />
        <dataInput id="_25_nextStatusKeyInput" name="nextStatusKey" />
        <inputSet>
          <dataInputRefs>_25_entityInput</dataInputRefs>
          <dataInputRefs>_25_nextStatusKeyInput</dataInputRefs>
        </inputSet>
        <outputSet>
        </outputSet>
      </ioSpecification>
      <dataInputAssociation>
        <sourceRef>contextEntity</sourceRef>
        <targetRef>_25_entityInput</targetRef>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>_25_nextStatusKeyInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">FUNDING_PLACEMENT_STATUS_FUNDED</from>
          <to xsi:type="tFormalExpression">_25_nextStatusKeyInput</to>
        </assignment>
      </dataInputAssociation>
    </task>
    <scriptTask id="_24" name="Increases the Pending Funded for New CP" scriptFormat="http://www.java.com/java" >
      <script>FundAllocator fundAllocator=(FundAllocator)context.getVariable("contextEntity");
BigDecimal newAmtRequested= fundAllocator.getFundAmt();
if(newAmtRequested==null )
	newAmtRequested=BigDecimal.ZERO; 

if(fundAllocator.getNewCP() != null){	
  CapitalProvider cp= fundAllocator.getNewCP();
  BigDecimal pending= cp.getPending();
  if(pending==null )
	 pending=BigDecimal.ZERO; 
     cp.setPending(pending.add(newAmtRequested));
 }</script>
    </scriptTask>
    <task id="_27" name="Save Entity" tns:taskName="SaveEntity" >
      <ioSpecification>
        <dataInput id="_27_entityInput" name="entity" />
        <inputSet>
          <dataInputRefs>_27_entityInput</dataInputRefs>
        </inputSet>
        <outputSet>
        </outputSet>
      </ioSpecification>
      <dataInputAssociation>
        <sourceRef>contextEntity</sourceRef>
        <targetRef>_27_entityInput</targetRef>
      </dataInputAssociation>
    </task>
    <task id="_26" name="Failed - StatusUpdate" tns:taskName="StatusUpdate" >
      <extensionElements>
        <tns:onEntry-script scriptFormat="http://www.java.com/java">
          <script>System.out.println("updating status - Failed----------------------------&gt;");</script>
        </tns:onEntry-script>
      </extensionElements>
      <ioSpecification>
        <dataInput id="_26_entityInput" name="entity" />
        <dataInput id="_26_nextStatusKeyInput" name="nextStatusKey" />
        <inputSet>
          <dataInputRefs>_26_entityInput</dataInputRefs>
          <dataInputRefs>_26_nextStatusKeyInput</dataInputRefs>
        </inputSet>
        <outputSet>
        </outputSet>
      </ioSpecification>
      <dataInputAssociation>
        <sourceRef>contextEntity</sourceRef>
        <targetRef>_26_entityInput</targetRef>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>_26_nextStatusKeyInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">FUNDING_PLACEMENT_STATUS_FAILED</from>
          <to xsi:type="tFormalExpression">_26_nextStatusKeyInput</to>
        </assignment>
      </dataInputAssociation>
    </task>
    <callActivity id="_29" name="FundAllocatorHistory" calledElement="FundAllocatorHistoryFlow" >
      <ioSpecification>
        <dataInput id="_29_fundAllocContextEntityInput" name="fundAllocContextEntity" />
        <inputSet>
          <dataInputRefs>_29_fundAllocContextEntityInput</dataInputRefs>
        </inputSet>
        <outputSet>
        </outputSet>
      </ioSpecification>
      <dataInputAssociation>
        <sourceRef>contextEntity</sourceRef>
        <targetRef>_29_fundAllocContextEntityInput</targetRef>
      </dataInputAssociation>
    </callActivity>
    <task id="_28" name="Replaced - StatusUpdate" tns:taskName="StatusUpdate" >
      <extensionElements>
        <tns:onEntry-script scriptFormat="http://www.java.com/java">
          <script>System.out.println("updating status - Replaced----------------------------&gt;");</script>
        </tns:onEntry-script>
      </extensionElements>
      <ioSpecification>
        <dataInput id="_28_entityInput" name="entity" />
        <dataInput id="_28_nextStatusKeyInput" name="nextStatusKey" />
        <inputSet>
          <dataInputRefs>_28_entityInput</dataInputRefs>
          <dataInputRefs>_28_nextStatusKeyInput</dataInputRefs>
        </inputSet>
        <outputSet>
        </outputSet>
      </ioSpecification>
      <dataInputAssociation>
        <sourceRef>contextEntity</sourceRef>
        <targetRef>_28_entityInput</targetRef>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>_28_nextStatusKeyInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">FUNDING_PLACEMENT_STATUS_REPLACED</from>
          <to xsi:type="tFormalExpression">_28_nextStatusKeyInput</to>
        </assignment>
      </dataInputAssociation>
    </task>

    <!-- connections -->
    <sequenceFlow id="_3-_2" sourceRef="_3" targetRef="_2" />
    <sequenceFlow id="_1-_3" sourceRef="_1" targetRef="_3" />
    <sequenceFlow id="_6-_5" sourceRef="_6" targetRef="_5" />
    <sequenceFlow id="_7-_6" sourceRef="_7" targetRef="_6" />
    <sequenceFlow id="_27-_7" sourceRef="_27" targetRef="_7" />
    <sequenceFlow id="_25-_8" sourceRef="_25" targetRef="_8" />
    <sequenceFlow id="_16-_11" sourceRef="_16" targetRef="_11" />
    <sequenceFlow id="_26-_11" sourceRef="_26" targetRef="_11" />
    <sequenceFlow id="_28-_11" sourceRef="_28" targetRef="_11" />
    <sequenceFlow id="_18-_15" sourceRef="_18" targetRef="_15" />
    <sequenceFlow id="_15-_16" sourceRef="_15" targetRef="_16" />
    <sequenceFlow id="_8-_18" sourceRef="_8" targetRef="_18" />
    <sequenceFlow id="_12-_23" sourceRef="_12" targetRef="_23" />
    <sequenceFlow id="_4-_25" sourceRef="_4" targetRef="_25" />
    <sequenceFlow id="_23-_24" sourceRef="_23" targetRef="_24" />
    <sequenceFlow id="_11-_27" sourceRef="_11" targetRef="_27" />
    <sequenceFlow id="_9-_26" sourceRef="_9" targetRef="_26" />
    <sequenceFlow id="_24-_29" sourceRef="_24" targetRef="_29" />
    <sequenceFlow id="_29-_28" sourceRef="_29" targetRef="_28" />

  </process>

  <bpmndi:BPMNDiagram>
    <bpmndi:BPMNPlane bpmnElement="FundAllocatorFlow" >
      <bpmndi:BPMNShape bpmnElement="_1" >
        <dc:Bounds x="134" y="23" width="48" height="48" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_2" >
        <dc:Bounds x="134" y="211" width="48" height="48" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_3" >
        <dc:Bounds x="83" y="110" width="150" height="62" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_4" >
        <dc:Bounds x="603" y="23" width="48" height="48" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_5" >
        <dc:Bounds x="331" y="901" width="48" height="48" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_6" >
        <dc:Bounds x="236" y="821" width="238" height="48" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_7" >
        <dc:Bounds x="239" y="741" width="233" height="48" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_8" >
        <dc:Bounds x="511" y="204" width="233" height="62" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_9" >
        <dc:Bounds x="86" y="399" width="48" height="48" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_11" >
        <dc:Bounds x="331" y="580" width="48" height="48" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_12" >
        <dc:Bounds x="326" y="117" width="48" height="48" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_15" >
        <dc:Bounds x="508" y="392" width="237" height="62" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_16" >
        <dc:Bounds x="507" y="486" width="234" height="62" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_18" >
        <dc:Bounds x="511" y="298" width="232" height="62" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_23" >
        <dc:Bounds x="228" y="204" width="244" height="62" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_25" >
        <dc:Bounds x="511" y="110" width="233" height="62" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_24" >
        <dc:Bounds x="221" y="298" width="258" height="62" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_27" >
        <dc:Bounds x="240" y="661" width="230" height="48" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_26" >
        <dc:Bounds x="16" y="486" width="188" height="62" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_29" >
        <dc:Bounds x="227" y="392" width="249" height="62" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_28" >
        <dc:Bounds x="236" y="486" width="239" height="62" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge bpmnElement="_3-_2" >
        <di:waypoint x="158" y="141" />
        <di:waypoint x="158" y="235" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_1-_3" >
        <di:waypoint x="158" y="47" />
        <di:waypoint x="158" y="141" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_6-_5" >
        <di:waypoint x="355" y="845" />
        <di:waypoint x="355" y="925" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_7-_6" >
        <di:waypoint x="355" y="765" />
        <di:waypoint x="355" y="845" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_27-_7" >
        <di:waypoint x="355" y="685" />
        <di:waypoint x="355" y="765" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_25-_8" >
        <di:waypoint x="627" y="141" />
        <di:waypoint x="627" y="235" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_16-_11" >
        <di:waypoint x="624" y="517" />
        <di:waypoint x="355" y="604" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_26-_11" >
        <di:waypoint x="110" y="517" />
        <di:waypoint x="355" y="604" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_28-_11" >
        <di:waypoint x="355" y="517" />
        <di:waypoint x="355" y="604" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_18-_15" >
        <di:waypoint x="627" y="329" />
        <di:waypoint x="626" y="423" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_15-_16" >
        <di:waypoint x="626" y="423" />
        <di:waypoint x="624" y="517" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_8-_18" >
        <di:waypoint x="627" y="235" />
        <di:waypoint x="627" y="329" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_12-_23" >
        <di:waypoint x="350" y="141" />
        <di:waypoint x="350" y="235" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_4-_25" >
        <di:waypoint x="627" y="47" />
        <di:waypoint x="627" y="141" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_23-_24" >
        <di:waypoint x="350" y="235" />
        <di:waypoint x="350" y="329" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_11-_27" >
        <di:waypoint x="355" y="604" />
        <di:waypoint x="355" y="685" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_9-_26" >
        <di:waypoint x="110" y="423" />
        <di:waypoint x="110" y="517" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_24-_29" >
        <di:waypoint x="350" y="329" />
        <di:waypoint x="351" y="423" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_29-_28" >
        <di:waypoint x="351" y="423" />
        <di:waypoint x="355" y="517" />
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>

</definitions>